[2024-08-28 17:08:20,016] 19 root - INFO - 
******************************
[2024-08-28 17:08:20,016] 20 root - INFO - >>>>>> Stage: Data Ingestion started <<<<<<
[2024-08-28 17:08:20,018] 32 root - INFO - Data Ingestion method starts
[2024-08-28 17:09:43,385] 36 root - INFO - Dataset read as pandas DataFrame
[2024-08-28 17:09:43,791] 41 root - INFO - Found 0 duplicate rows
[2024-08-28 17:09:43,901] 43 root - INFO - Drop duplicates
[2024-08-28 17:09:45,072] 47 root - INFO - Raw data saved
[2024-08-28 17:09:46,416] 53 root - INFO - Ingestion of Data is completed
[2024-08-28 17:09:46,432] 23 root - INFO - >>>>>> Stage: Data Ingestion completed <<<<<<
xxxxxxxxxxxxxxxxxxxx

[2024-08-28 17:09:46,432] 26 root - INFO - ******************************
[2024-08-28 17:09:46,432] 27 root - INFO - >>>>>> Stage: Data Transformation started <<<<<<
[2024-08-28 17:09:47,010] 112 root - INFO - Read train and test data completed
[2024-08-28 17:09:47,135] 124 root - INFO - Converting output column into numerical form using Ordinal Encoding
[2024-08-28 17:09:47,135] 125 root - INFO - Approved_Flag column converted to numerical values: ['P1', 'P2', 'P3', 'P4']
[2024-08-28 17:09:47,432] 127 root - INFO - Train Dataframe head: 
   PROSPECTID  Total_TL  Tot_Closed_TL  Tot_Active_TL  Total_TL_opened_L6M  Tot_TL_closed_L6M  pct_tl_open_L6M  pct_tl_closed_L6M  pct_active_tl  pct_closed_tl  Total_TL_opened_L12M  Tot_TL_closed_L12M  pct_tl_open_L12M  pct_tl_closed_L12M  Tot_Missed_Pmnt  Auto_TL  CC_TL  Consumer_TL  Gold_TL  Home_TL  PL_TL  Secured_TL  Unsecured_TL  Other_TL  Age_Oldest_TL  Age_Newest_TL  time_since_recent_payment  num_times_delinquent  max_recent_level_of_deliq  num_deliq_6mts  num_deliq_12mts  num_deliq_6_12mts  num_times_30p_dpd  num_times_60p_dpd  num_std  num_std_6mts  num_std_12mts  num_sub  num_sub_6mts  num_sub_12mts  num_dbt  num_dbt_6mts  num_dbt_12mts  num_lss  num_lss_6mts  num_lss_12mts  recent_level_of_deliq  tot_enq  CC_enq  CC_enq_L6m  CC_enq_L12m  PL_enq  PL_enq_L6m  PL_enq_L12m  time_since_recent_enq  enq_L12m  enq_L6m  enq_L3m MARITALSTATUS  EDUCATION  AGE GENDER  NETMONTHLYINCOME  Time_With_Curr_Empr  pct_of_active_TLs_ever  pct_opened_TLs_L6m_of_L12m  pct_currentBal_all_TL  CC_Flag  PL_Flag  pct_PL_enq_L6m_of_L12m  pct_CC_enq_L6m_of_L12m  pct_PL_enq_L6m_of_ever  pct_CC_enq_L6m_of_ever  HL_Flag  GL_Flag last_prod_enq2 first_prod_enq2  Credit_Score  Approved_Flag
0       39321        32             23              9                    2                  1            0.062              0.031          0.281          0.719                     5                   2             0.156               0.062                1        1      0            0        6        5      1          31             1        19            189              3                         40                    10                         30               0                0                  0                  3                  0      125             3              8        0             0              0        0             0              0        0             0              0                     30        9       0           0            0       0           0            0                    279         1        0        0       Married          2   49      M             52000                   71                   0.281                         0.4                  0.926        0        1                     0.0                     0.0                     0.0                     0.0        1        1             HL              HL           714            0.0
1       34836         2              1              1                    0                  0            0.000              0.000          0.500          0.500                     1                   0             0.500               0.000                0        0      0            1        0        0      0           1             1         1             66             12                         89                     0                          0               0                0                  0                  0                  0       18             0              0        0             0              0        0             0              0        0             0              0                      0        1       0           0            0       1           0            1                    352         1        0        0       Married          2   44      M             25000                  251                   0.500                         0.0                  0.000        0        0                     0.0                     0.0                     0.0                     0.0        0        0             PL              PL           687            1.0
2       46291         1              0              1                    0                  0            0.000              0.000          1.000          0.000                     1                   0             1.000               0.000                0        1      0            0        0        0      0           1             0         0              8              8                        107                     0                          0               0                0                  0                  0                  0        0             0              0        0             0              0        0             0              0        0             0              0                      0        1       0           0            0       0           0            0                    256         1        0        0       Married          3   25      F            100000                   63                   1.000                         0.0                  0.808        0        0                     0.0                     0.0                     0.0                     0.0        0        0         others          others           681            1.0
3       50235         1              0              1                    0                  0            0.000              0.000          1.000          0.000                     0                   0             0.000               0.000                0        0      0            1        0        0      0           0             1         0             19             19                        362                     0                          0               0                0                  0                  0                  0        0             0              0        0             0              0        0             0              0        0             0              0                      0        5       0           0            0       0           0            0                     44         3        2        2       Married          4   34      M             23000                   70                   1.000                         0.0                  0.000        0        0                     0.0                     0.0                     0.0                     0.0        0        0   ConsumerLoan    ConsumerLoan           666            2.0
4       49853         2              0              2                    1                  0            0.500              0.000          1.000          0.000                     1                   0             0.500               0.000                0        1      0            0        0        0      0           1             1         1             90              3                         52                     0                          0               0                0                  0                  0                  0        1             0              1        0             0              0        0             0              0        0             0              0                      0        4       0           0            0       0           0            0                    111         4        4        0        Single          3   23      M             25000                  129                   1.000                         1.0                  0.948        0        0                     0.0                     0.0                     0.0                     0.0        0        0         others          others           701            0.0
[2024-08-28 17:09:47,447] 128 root - INFO - Test Dataframe head: 
   PROSPECTID  Total_TL  Tot_Closed_TL  Tot_Active_TL  Total_TL_opened_L6M  Tot_TL_closed_L6M  pct_tl_open_L6M  pct_tl_closed_L6M  pct_active_tl  pct_closed_tl  Total_TL_opened_L12M  Tot_TL_closed_L12M  pct_tl_open_L12M  pct_tl_closed_L12M  Tot_Missed_Pmnt  Auto_TL  CC_TL  Consumer_TL  Gold_TL  Home_TL  PL_TL  Secured_TL  Unsecured_TL  Other_TL  Age_Oldest_TL  Age_Newest_TL  time_since_recent_payment  num_times_delinquent  max_recent_level_of_deliq  num_deliq_6mts  num_deliq_12mts  num_deliq_6_12mts  num_times_30p_dpd  num_times_60p_dpd  num_std  num_std_6mts  num_std_12mts  num_sub  num_sub_6mts  num_sub_12mts  num_dbt  num_dbt_6mts  num_dbt_12mts  num_lss  num_lss_6mts  num_lss_12mts  recent_level_of_deliq  tot_enq  CC_enq  CC_enq_L6m  CC_enq_L12m  PL_enq  PL_enq_L6m  PL_enq_L12m  time_since_recent_enq  enq_L12m  enq_L6m  enq_L3m MARITALSTATUS  EDUCATION  AGE GENDER  NETMONTHLYINCOME  Time_With_Curr_Empr  pct_of_active_TLs_ever  pct_opened_TLs_L6m_of_L12m  pct_currentBal_all_TL  CC_Flag  PL_Flag  pct_PL_enq_L6m_of_L12m  pct_CC_enq_L6m_of_L12m  pct_PL_enq_L6m_of_ever  pct_CC_enq_L6m_of_ever  HL_Flag  GL_Flag last_prod_enq2 first_prod_enq2  Credit_Score  Approved_Flag
0       34786         4              0              4                    3                  0            0.750                0.0            1.0            0.0                     4                   0             1.000               0.000                2        0      0            2        0        0      0           0             4         2              8              2                         70                     0                          0               0                0                  0                  0                  0        0             0              0        0             0              0        0             0              0        0             0              0                      0        2       0           0            0       1           1            1                    127         2        1        0        Single          3   22      M             15000                   31                     1.0                       0.750                  0.673        0        0                    1.00                     0.0                    1.00                     0.0        0        0             PL          others           667            2.0
1       23100         2              0              2                    0                  0            0.000                0.0            1.0            0.0                     0                   0             0.000               0.000                1        0      0            0        0        0      0           1             1         2             86             36                        960                     0                          0               0                0                  0                  0                  0       10             0              0        0             0              0        0             0              0        0             0              0                      0        1       0           0            0       0           0            0                    571         0        0        0       Married          3   34      F              8500                   41                     1.0                       0.000                  0.091        0        0                    0.00                     0.0                    0.00                     0.0        0        0         others          others           691            1.0
2       30148         1              0              1                    0                  0            0.000                0.0            1.0            0.0                     0                   0             0.000               0.000                0        1      0            0        0        0      0           1             0         0             62             62                        391                     0                          0               0                0                  0                  0                  0       33             5             11        0             0              0        0             0              0        0             0              0                      0        1       0           0            0       0           0            0                   1860         0        0        0       Married          3   36      M             30000                  154                     1.0                       0.000                  0.000        0        0                    0.00                     0.0                    0.00                     0.0        0        0         others          others           710            0.0
3        8325         2              2              0                    1                  2            0.500                1.0            0.0            1.0                     2                   2             1.000               1.000                0        0      0            0        0        0      2           0             2         0              7              4                        118                     0                          0               0                0                  0                  0                  0        1             1              1        0             0              0        0             0              0        0             0              0                      0        4       0           0            0       4           1            4                     69         4        1        1        Single          3   21      M             16000                   42                     0.0                       0.500                  0.000        0        1                    0.25                     0.0                    0.25                     0.0        0        0             PL              PL           664            2.0
4       24131        14              7              7                    2                  0            0.143                0.0            0.5            0.5                     3                   2             0.214               0.143                2        1      6            3        0        0      4           1            13         0             80              2                         58                     0                          0               0                0                  0                  0                  0        0             0              0        0             0              0        0             0              0        0             0              0                      0       25       7           0            1      14           0            7                    125        11        3        0       Married          3   33      M             28000                   45                     0.5                       0.667                  1.042        1        1                    0.00                     0.0                    0.00                     0.0        0        0         others              CC           698            1.0
[2024-08-28 17:09:47,526] 139 root - INFO - Train(input) Dataframe head: 
   PROSPECTID  Total_TL  Tot_Closed_TL  Tot_Active_TL  Total_TL_opened_L6M  Tot_TL_closed_L6M  pct_tl_open_L6M  pct_tl_closed_L6M  pct_active_tl  pct_closed_tl  Total_TL_opened_L12M  Tot_TL_closed_L12M  pct_tl_open_L12M  pct_tl_closed_L12M  Tot_Missed_Pmnt  Auto_TL  CC_TL  Consumer_TL  Gold_TL  Home_TL  PL_TL  Secured_TL  Unsecured_TL  Other_TL  Age_Oldest_TL  Age_Newest_TL  time_since_recent_payment  num_times_delinquent  max_recent_level_of_deliq  num_deliq_6mts  num_deliq_12mts  num_deliq_6_12mts  num_times_30p_dpd  num_times_60p_dpd  num_std  num_std_6mts  num_std_12mts  num_sub  num_sub_6mts  num_sub_12mts  num_dbt  num_dbt_6mts  num_dbt_12mts  num_lss  num_lss_6mts  num_lss_12mts  recent_level_of_deliq  tot_enq  CC_enq  CC_enq_L6m  CC_enq_L12m  PL_enq  PL_enq_L6m  PL_enq_L12m  time_since_recent_enq  enq_L12m  enq_L6m  enq_L3m MARITALSTATUS  EDUCATION  AGE GENDER  NETMONTHLYINCOME  Time_With_Curr_Empr  pct_of_active_TLs_ever  pct_opened_TLs_L6m_of_L12m  pct_currentBal_all_TL  CC_Flag  PL_Flag  pct_PL_enq_L6m_of_L12m  pct_CC_enq_L6m_of_L12m  pct_PL_enq_L6m_of_ever  pct_CC_enq_L6m_of_ever  HL_Flag  GL_Flag last_prod_enq2 first_prod_enq2  Credit_Score
0       39321        32             23              9                    2                  1            0.062              0.031          0.281          0.719                     5                   2             0.156               0.062                1        1      0            0        6        5      1          31             1        19            189              3                         40                    10                         30               0                0                  0                  3                  0      125             3              8        0             0              0        0             0              0        0             0              0                     30        9       0           0            0       0           0            0                    279         1        0        0       Married          2   49      M             52000                   71                   0.281                         0.4                  0.926        0        1                     0.0                     0.0                     0.0                     0.0        1        1             HL              HL           714
1       34836         2              1              1                    0                  0            0.000              0.000          0.500          0.500                     1                   0             0.500               0.000                0        0      0            1        0        0      0           1             1         1             66             12                         89                     0                          0               0                0                  0                  0                  0       18             0              0        0             0              0        0             0              0        0             0              0                      0        1       0           0            0       1           0            1                    352         1        0        0       Married          2   44      M             25000                  251                   0.500                         0.0                  0.000        0        0                     0.0                     0.0                     0.0                     0.0        0        0             PL              PL           687
[2024-08-28 17:09:47,557] 140 root - INFO - Test(input) Dataframe head: 
   PROSPECTID  Total_TL  Tot_Closed_TL  Tot_Active_TL  Total_TL_opened_L6M  Tot_TL_closed_L6M  pct_tl_open_L6M  pct_tl_closed_L6M  pct_active_tl  pct_closed_tl  Total_TL_opened_L12M  Tot_TL_closed_L12M  pct_tl_open_L12M  pct_tl_closed_L12M  Tot_Missed_Pmnt  Auto_TL  CC_TL  Consumer_TL  Gold_TL  Home_TL  PL_TL  Secured_TL  Unsecured_TL  Other_TL  Age_Oldest_TL  Age_Newest_TL  time_since_recent_payment  num_times_delinquent  max_recent_level_of_deliq  num_deliq_6mts  num_deliq_12mts  num_deliq_6_12mts  num_times_30p_dpd  num_times_60p_dpd  num_std  num_std_6mts  num_std_12mts  num_sub  num_sub_6mts  num_sub_12mts  num_dbt  num_dbt_6mts  num_dbt_12mts  num_lss  num_lss_6mts  num_lss_12mts  recent_level_of_deliq  tot_enq  CC_enq  CC_enq_L6m  CC_enq_L12m  PL_enq  PL_enq_L6m  PL_enq_L12m  time_since_recent_enq  enq_L12m  enq_L6m  enq_L3m MARITALSTATUS  EDUCATION  AGE GENDER  NETMONTHLYINCOME  Time_With_Curr_Empr  pct_of_active_TLs_ever  pct_opened_TLs_L6m_of_L12m  pct_currentBal_all_TL  CC_Flag  PL_Flag  pct_PL_enq_L6m_of_L12m  pct_CC_enq_L6m_of_L12m  pct_PL_enq_L6m_of_ever  pct_CC_enq_L6m_of_ever  HL_Flag  GL_Flag last_prod_enq2 first_prod_enq2  Credit_Score
0       34786         4              0              4                    3                  0             0.75                0.0            1.0            0.0                     4                   0               1.0                 0.0                2        0      0            2        0        0      0           0             4         2              8              2                         70                     0                          0               0                0                  0                  0                  0        0             0              0        0             0              0        0             0              0        0             0              0                      0        2       0           0            0       1           1            1                    127         2        1        0        Single          3   22      M             15000                   31                     1.0                        0.75                  0.673        0        0                     1.0                     0.0                     1.0                     0.0        0        0             PL          others           667
1       23100         2              0              2                    0                  0             0.00                0.0            1.0            0.0                     0                   0               0.0                 0.0                1        0      0            0        0        0      0           1             1         2             86             36                        960                     0                          0               0                0                  0                  0                  0       10             0              0        0             0              0        0             0              0        0             0              0                      0        1       0           0            0       0           0            0                    571         0        0        0       Married          3   34      F              8500                   41                     1.0                        0.00                  0.091        0        0                     0.0                     0.0                     0.0                     0.0        0        0         others          others           691
[2024-08-28 17:09:47,557] 44 root - INFO - Data Transformation initiated
[2024-08-28 17:09:47,557] 65 root - INFO - Pipeline Initiated
[2024-08-28 17:09:47,557] 95 root - INFO - Pipeline Completed
[2024-08-28 17:09:47,937] 149 root - INFO - Applying preprocessing object on training and testing datasets.
[2024-08-28 17:09:48,077] 159 root - INFO - Preprocessor pickle file saved
[2024-08-28 17:09:48,109] 30 root - INFO - >>>>>> Stage: Data Transformation completed <<<<<<
xxxxxxxxxxxxxxxxxxxx

[2024-08-28 17:09:48,109] 33 root - INFO - ******************************
[2024-08-28 17:09:48,109] 34 root - INFO - >>>>>> Stage: Model Training started <<<<<<
[2024-08-28 17:09:48,109] 31 root - INFO - Split training and test input data
[2024-08-28 17:09:48,290] 47 root - INFO - Exception occured during model training
[2024-08-28 17:09:48,290] 40 root - ERROR - An error occurred: Error in c:\users\harshali\documents\crm\src\components\model_trainer.py at line 47: Error in c:\users\harshali\documents\crm\src\utils.py at line 35: Input X contains NaN.
RandomForestClassifier does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
